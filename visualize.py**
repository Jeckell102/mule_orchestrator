import sqlite3, pandas as pd, os
def show():
db = 'logs/mule_results.db'
if not os.path.exists(db): return
conn = sqlite3.connect(db)
try:
# Team Chart
df = pd.read_sql('SELECT specialist_consulted, COUNT(*) as count FROM mule_audit GROUP BY specialist_consulted', conn)
print('\nüìä TEAM UTILIZATION CHART')
print("-" * 35)
for _, r in df.iterrows():
print(f"{str(r['specialist_consulted']):<15} | {'‚ñà' * int(r['count'])} ({r['count']})")

    # Drift Log
    print('\nüìâ RECENT FAILURE DRIFT (Relative to MRD)')
    print("-" * 35)
    drift_df = pd.read_sql("SELECT prompt, drift, status FROM mule_audit WHERE status='FAIL' ORDER BY id DESC LIMIT 5", conn)
    for _, r in drift_df.iterrows():
        print(f"{r['prompt'][:18]:<18} | +{r['drift']:>5} (OVER LIMIT)")
except Exception as e: print(f"‚ùå [ERROR] {e}")
finally: conn.close()


if **name** == '**main**': show()